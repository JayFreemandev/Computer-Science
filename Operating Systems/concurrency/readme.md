# 동시성
상위에는 복숭아들이 놓여져있고 먹고 싶은 사람이 복숭아를 집어 먹으면 다른 사람이랑 내가 같은 복숭아를 보고있는 경우 손 빠른 사람이 가져가고 나는 굶게된다. 일열로 줄을 세워서 자기 차례가 되면 복숭아를 집어가게하면 정확하게 하나씩 가져가지만 느리다. 이것이 병행성이다.

## 병행 프로그램의 공통적인 문제
이번 장에서는 프로세스를 위한 새로운 개념인 쓰레드(thread)를 소개한다. 프로그
램에서 한 순간에 하나의 명령어만을 실행하는 (단일 PC1 값) 고전적인 관점에서 벗어나
멀티 쓰레드 프로그램은 하나 이상의 실행 지점 (독립적으로 불러 들여지고 실행될 수
있는 여러 개의 PC 값)을 가지고 있다. 멀티 쓰레드를 이해하는 다른 방법은 각 쓰레드가
프로세스와 매우 유사하지만, 차이가 있다면 쓰레드들은 주소 공간을 공유하기 때문에
동일한 값에 접근할 수 있다는 것이다.


하나의 쓰레드의 상태는 프로세스의 상태와 매우 유사하다. 쓰레드는 어디서 명령어
들을 불러 들일지 추적하는 프로그램 카운터 (PC)와 연산을 위한 레지스터들을 가지고
있다. 만약 두 개의 쓰레드가 하나의 프로세서에서 실행 중이라면 실행하고자 하는
쓰레드 (T2)는 반드시 문맥 교환(context switch)을 통해서 실행 중인 쓰레드 (T1)와
교체되어야 한다. 쓰레드 간의 문맥 교환은 T1이 사용하던 레지스터들을 저장하고 T2가
사용하던 레지스터의 내용으로 복원한다는 점에서 프로세스의 문맥 교환과 유사하다. 프
로세스가 문맥 교환을 할 때에 프로세스의 상태를 프로세스 제어 블럭(process control
block, PCB)에 저장하듯이 프로세스의 쓰레드들의 상태를 저장하기 위해서는 하나
또는 그 이상의 쓰레드 제어 블럭(thread control block, TCB)이 필요하다. 가장
큰 차이 중 하나는 프로세스의 경우와 달리 쓰레드 간의 문맥 교환에서는 주소 공간을
그대로 사용한다는 것이다 (사용하고 있던 페이지 테이블을 그대로 사용하면 된다).
쓰레드와 프로세스의 또 다른 차이는 스택에 있다. 고전적 프로세스 주소 공간과
같은 간단한 모델 (단일 쓰레드 프로세스)에서는 스택이 하나만 존재한다.
